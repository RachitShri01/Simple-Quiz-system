<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Local Quiz Studio</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      --bg: #0f172a;
      --bg-alt: #020617;
      --card: #020617;
      --accent: #38bdf8;
      --accent-soft: rgba(56, 189, 248, 0.1);
      --accent-strong: #0ea5e9;
      --danger: #ef4444;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --border: #1f2933;
      --radius-lg: 18px;
      --radius-md: 10px;
      --shadow-lg: 0 24px 60px rgba(15, 23, 42, 0.9);
      --shadow-soft: 0 18px 40px rgba(15, 23, 42, 0.7);
      --input-bg: #020617;
      --input-border: #111827;
      --transition-fast: 160ms ease-out;
      --transition-med: 220ms ease-out;
    }

    * {
      box-sizing: border-box;
    }

    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
        "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #1e293b 0, #020617 40%, #020617 100%);
      color: var(--text);
    }

    body {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 24px;
    }

    .app-shell {
      width: 100%;
      max-width: 1080px;
      min-height: 620px;
      background: linear-gradient(135deg, rgba(148, 163, 184, 0.08), transparent),
                  radial-gradient(circle at top left, rgba(56, 189, 248, 0.25), transparent 55%),
                  radial-gradient(circle at bottom right, rgba(59, 130, 246, 0.2), transparent 50%);
      border-radius: 28px;
      padding: 2px;
      box-shadow: var(--shadow-lg);
      position: relative;
      overflow: hidden;
    }

    .app-inner {
      height: 100%;
      background: linear-gradient(135deg, #020617, #020617 30%, #020617 100%);
      border-radius: 26px;
      display: grid;
      grid-template-columns: minmax(0, 1.25fr) minmax(0, 2fr);
      overflow: hidden;
    }

    /* Left pane */
    .app-aside {
      padding: 32px;
      border-right: 1px solid rgba(15, 23, 42, 0.85);
      background: radial-gradient(circle at top, rgba(148, 163, 184, 0.18), transparent 65%),
                  linear-gradient(180deg, rgba(15, 23, 42, 0.95), rgba(2, 6, 23, 1));
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }

    .logo-row {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .logo-mark {
      width: 32px;
      height: 32px;
      border-radius: 12px;
      background: radial-gradient(circle at 25% 0, #f9fafb 0, #38bdf8 25%, #0f172a 70%);
      box-shadow: 0 0 0 1px rgba(15, 23, 42, 0.9),
                  0 10px 30px rgba(15, 23, 42, 0.9);
      position: relative;
      overflow: hidden;
    }

    .logo-mark::after {
      content: "";
      position: absolute;
      inset: 7px;
      border-radius: 10px;
      border: 1px solid rgba(15, 23, 42, 0.75);
      background: radial-gradient(circle at top, rgba(248, 250, 252, 0.9), transparent 55%);
      mix-blend-mode: screen;
      opacity: 0.7;
    }

    .logo-text-main {
      font-size: 16px;
      font-weight: 600;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      color: #e5e7eb;
    }

    .logo-text-sub {
      font-size: 11px;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 0.2em;
    }

    .aside-hero {
      margin-top: 48px;
    }

    .aside-heading {
      font-size: 26px;
      line-height: 1.3;
      font-weight: 650;
      letter-spacing: 0.02em;
      margin-bottom: 12px;
    }

    .aside-heading span {
      color: var(--accent);
    }

    .aside-body {
      font-size: 13px;
      color: var(--muted);
      max-width: 320px;
    }

    .aside-highlights {
      margin-top: 40px;
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 12px;
    }

    .pill {
      font-size: 11px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.25);
      color: var(--muted);
      background: radial-gradient(circle at top left, rgba(56, 189, 248, 0.2), transparent 60%);
      backdrop-filter: blur(10px);
      display: inline-flex;
      align-items: center;
      gap: 6px;
      white-space: nowrap;
    }

    .pill-dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: var(--accent);
      box-shadow: 0 0 14px rgba(56, 189, 248, 0.85);
    }

    .aside-footer {
      font-size: 11px;
      color: var(--muted);
      opacity: 0.9;
    }

    .aside-footer span {
      color: var(--accent);
    }

    /* Right pane */
    .app-main {
      padding: 26px 28px 24px 28px;
      display: flex;
      flex-direction: column;
      gap: 18px;
    }

    .top-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 16px;
    }

    .top-title {
      font-size: 15px;
      font-weight: 600;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      color: #9ca3af;
    }

    .status-badge {
      font-size: 11px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(55, 65, 81, 1);
      color: var(--muted);
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: linear-gradient(135deg, #020617, #020617);
    }

    .status-dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: #22c55e;
      box-shadow: 0 0 12px rgba(34, 197, 94, 0.75);
    }

    .user-chip {
      font-size: 11px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(31, 41, 55, 1);
      color: var(--muted);
      background: rgba(15, 23, 42, 0.95);
      max-width: 220px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .card-shell {
      flex: 1;
      min-height: 0;
      background: radial-gradient(circle at top left, rgba(56, 189, 248, 0.16), transparent 60%),
                  linear-gradient(145deg, rgba(15, 23, 42, 0.98), rgba(2, 6, 23, 1));
      border-radius: var(--radius-lg);
      border: 1px solid rgba(15, 23, 42, 0.98);
      box-shadow: var(--shadow-soft);
      padding: 18px 20px 18px 20px;
      position: relative;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      gap: 14px;
    }

    .card-shell::before {
      content: "";
      position: absolute;
      inset: -40%;
      background:
        radial-gradient(circle at top, rgba(148, 163, 184, 0.16), transparent 55%),
        radial-gradient(circle at bottom right, rgba(56, 189, 248, 0.18), transparent 60%);
      opacity: 0.6;
      pointer-events: none;
    }

    .card-inner {
      position: relative;
      z-index: 1;
      display: flex;
      flex-direction: column;
      gap: 14px;
      min-height: 0;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
    }

    .card-header-main {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .card-title {
      font-size: 17px;
      font-weight: 600;
      letter-spacing: 0.03em;
    }

    .card-subtitle {
      font-size: 13px;
      color: var(--muted);
    }

    .chip-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      font-size: 11px;
      color: var(--muted);
    }

    .chip {
      padding: 4px 8px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.96);
      border: 1px solid rgba(31, 41, 55, 1);
    }

    .hint {
      font-size: 11px;
      color: var(--muted);
    }

    .hint a {
      color: var(--accent);
      text-decoration: none;
      font-weight: 500;
    }

    .hint a:hover {
      text-decoration: underline;
    }

    .divider {
      height: 1px;
      border-radius: 999px;
      background: linear-gradient(to right,
        transparent,
        rgba(15, 23, 42, 0.9),
        rgba(15, 23, 42, 0.9),
        transparent
      );
      margin: 2px 0;
    }

    .status-line {
      font-size: 12px;
      color: var(--muted);
      min-height: 18px;
    }

    .status-line strong {
      color: var(--accent);
      font-weight: 500;
    }

    /* General form styles */
    .form-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 10px 16px;
      margin-top: 4px;
    }

    @media (max-width: 900px) {
      .app-inner {
        grid-template-columns: 1fr;
      }
      .app-aside {
        display: none;
      }
    }

    @media (max-width: 640px) {
      .form-grid {
        grid-template-columns: 1fr;
      }
      body {
        padding: 16px;
      }
      .app-shell {
        min-height: 560px;
      }
    }

    .field-group {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    label {
      font-size: 12px;
      color: #9ca3af;
    }

    input[type="text"],
    input[type="password"],
    input[type="email"],
    textarea {
      background: linear-gradient(145deg, var(--input-bg), #020617);
      border-radius: var(--radius-md);
      border: 1px solid var(--input-border);
      padding: 8px 10px;
      color: var(--text);
      font-size: 13px;
      outline: none;
      transition: border-color var(--transition-fast), box-shadow var(--transition-fast),
                  background-color var(--transition-fast), transform 120ms ease-out;
    }

    input::placeholder,
    textarea::placeholder {
      color: #4b5563;
    }

    input:focus,
    textarea:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px rgba(56, 189, 248, 0.4), 0 0 0 10px rgba(15, 23, 42, 0.8);
      background-color: #020617;
      transform: translateY(-0.5px);
    }

    .inline-link {
      border: none;
      background: none;
      padding: 0;
      margin: 0;
      color: var(--accent);
      font-size: 12px;
      cursor: pointer;
      text-decoration: underline;
    }

    /* Buttons */
    .button-row {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
      margin-top: 8px;
      flex-wrap: wrap;
    }

    .btn {
      border-radius: 999px;
      border: 1px solid rgba(31, 41, 55, 1);
      padding: 7px 13px;
      font-size: 12px;
      font-weight: 500;
      color: #e5e7eb;
      background: radial-gradient(circle at top, rgba(148, 163, 184, 0.18), transparent 60%),
                  linear-gradient(135deg, #020617, #020617);
      cursor: pointer;
      transition: background var(--transition-med), transform 120ms ease-out,
                  box-shadow var(--transition-med), border-color var(--transition-med);
      display: inline-flex;
      align-items: center;
      gap: 7px;
      white-space: nowrap;
    }

    .btn:hover {
      background: radial-gradient(circle at top left, rgba(56, 189, 248, 0.2), transparent 60%),
                  linear-gradient(135deg, #020617, #020617);
      transform: translateY(-1px);
      box-shadow: 0 10px 30px rgba(15, 23, 42, 0.8);
      border-color: rgba(55, 65, 81, 1);
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--accent-strong), #0ea5e9);
      border-color: rgba(56, 189, 248, 0.9);
      color: #0b1120;
      box-shadow: 0 18px 40px rgba(8, 47, 73, 0.9);
    }

    .btn-primary:hover {
      background: linear-gradient(135deg, #38bdf8, #22d3ee);
      transform: translateY(-1px);
      box-shadow: 0 20px 42px rgba(8, 47, 73, 0.95);
    }

    .btn-ghost {
      background: transparent;
      border-color: rgba(31, 41, 55, 1);
      color: var(--muted);
    }

    .btn-ghost:hover {
      background: rgba(15, 23, 42, 0.95);
      color: #e5e7eb;
    }

    .btn-danger {
      background: linear-gradient(135deg, #ef4444, #dc2626);
      border-color: rgba(239, 68, 68, 0.9);
      color: #0b1120;
      box-shadow: 0 18px 40px rgba(127, 29, 29, 0.9);
    }

    .btn-danger:hover {
      background: linear-gradient(135deg, #f97373, #ef4444);
    }

    .btn-sm {
      font-size: 11px;
      padding: 5px 10px;
      border-radius: 999px;
    }

    /* Tabs for login/signup */
    .tabs {
      display: flex;
      gap: 6px;
      border-radius: 999px;
      padding: 3px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(15, 23, 42, 0.95);
      width: fit-content;
    }

    .tab {
      font-size: 11px;
      padding: 5px 10px;
      border-radius: 999px;
      cursor: pointer;
      border: none;
      background: transparent;
      color: var(--muted);
    }

    .tab.active {
      background: radial-gradient(circle at top left, rgba(56, 189, 248, 0.22), transparent 55%);
      color: #e5e7eb;
    }

    .content-scroll {
      flex: 1;
      min-height: 0;
      overflow: auto;
      padding-right: 6px;
      margin-right: -2px;
      padding-top: 6px;
    }

    .content-scroll::-webkit-scrollbar {
      width: 6px;
    }

    .content-scroll::-webkit-scrollbar-track {
      background: transparent;
    }

    .content-scroll::-webkit-scrollbar-thumb {
      background: rgba(30, 64, 175, 0.7);
      border-radius: 999px;
    }

    .view {
      display: none;
      animation: fadeIn 180ms ease-out;
    }

    .view.active {
      display: block;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(4px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Dashboard */
    .metrics-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 10px;
    }

    .metric-card {
      flex: 1;
      min-width: 120px;
      max-width: 180px;
      border-radius: 12px;
      padding: 8px 10px;
      background: rgba(15, 23, 42, 0.96);
      border: 1px solid rgba(31, 41, 55, 1);
      display: flex;
      flex-direction: column;
      gap: 4px;
      font-size: 12px;
    }

    .metric-label {
      color: var(--muted);
      font-size: 11px;
    }

    .metric-value {
      font-size: 15px;
      font-weight: 600;
    }

    .metric-sub {
      font-size: 11px;
      color: var(--muted);
    }

    .quiz-list {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-top: 8px;
    }

    .quiz-card {
      border-radius: 14px;
      padding: 10px 11px;
      background: rgba(15, 23, 42, 0.98);
      border: 1px solid rgba(31, 41, 55, 1);
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 10px;
      transition: background var(--transition-fast), transform 120ms ease-out,
                  border-color var(--transition-fast), box-shadow 160ms ease-out;
      cursor: pointer;
    }

    .quiz-card:hover {
      background: radial-gradient(circle at top left, rgba(56, 189, 248, 0.18), transparent 60%),
                  rgba(15, 23, 42, 0.98);
      transform: translateY(-1px);
      border-color: rgba(55, 65, 81, 1);
      box-shadow: 0 10px 26px rgba(15, 23, 42, 0.9);
    }

    .quiz-main {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .quiz-title {
      font-size: 13px;
      font-weight: 500;
    }

    .quiz-meta {
      font-size: 11px;
      color: var(--muted);
    }

    .quiz-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .empty-state {
      margin-top: 8px;
      padding: 10px 11px;
      border-radius: 12px;
      border: 1px dashed rgba(55, 65, 81, 1);
      background: rgba(15, 23, 42, 0.9);
      font-size: 12px;
      color: var(--muted);
    }

    .pill-small {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid rgba(31, 41, 55, 1);
      font-size: 10px;
      color: var(--muted);
      background: rgba(15, 23, 42, 0.96);
    }

    .pill-icon {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: var(--accent);
    }

    .danger-note {
      font-size: 11px;
      color: #fca5a5;
      margin-top: 4px;
    }

    .mt-8 { margin-top: 8px; }
    .mt-4 { margin-top: 4px; }
    .mt-2 { margin-top: 2px; }

    /* Editor */
    .editor-section {
      border-radius: 14px;
      padding: 10px 12px;
      margin-top: 10px;
      background: rgba(15, 23, 42, 0.95);
      border: 1px solid rgba(31, 41, 55, 1);
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .editor-title-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
    }

    .editor-title-row h3 {
      margin: 0;
      font-size: 14px;
      font-weight: 500;
    }

    .questions-list {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .question-card {
      border-radius: 12px;
      padding: 10px;
      background: linear-gradient(135deg, #020617, #020617);
      border: 1px solid rgba(31, 41, 55, 1);
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .question-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }

    .question-label {
      font-size: 12px;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 0.06em;
    }

    .question-actions {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
    }

    .options-list {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-top: 4px;
    }

    .option-row {
      display: grid;
      grid-template-columns: auto minmax(0, 1fr) auto;
      gap: 6px;
      align-items: center;
    }

    .option-radio {
      accent-color: var(--accent);
      cursor: pointer;
    }

    .option-delete-btn {
      border: none;
      background: none;
      color: var(--muted);
      cursor: pointer;
      font-size: 11px;
      padding: 2px 4px;
      border-radius: 999px;
      transition: background var(--transition-fast), color var(--transition-fast);
    }

    .option-delete-btn:hover {
      background: rgba(15, 23, 42, 0.95);
      color: #fca5a5;
    }

    /* Quiz view (play) */
    .quiz-view-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
    }

    .quiz-view-title {
      font-size: 15px;
      font-weight: 600;
    }

    .quiz-view-meta {
      font-size: 12px;
      color: var(--muted);
    }

    .quiz-view-question {
      border-radius: 12px;
      padding: 10px;
      background: linear-gradient(135deg, #020617, #020617);
      border: 1px solid rgba(31, 41, 55, 1);
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 8px;
    }

    .quiz-view-qtext {
      font-size: 13px;
      font-weight: 500;
    }

    .quiz-view-options {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .quiz-view-option {
      border-radius: 8px;
      padding: 6px 8px;
      border: 1px solid rgba(31, 41, 55, 1);
      background: rgba(15, 23, 42, 0.96);
      cursor: pointer;
      font-size: 12px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      transition: background 150ms ease-out, border-color 150ms ease-out, transform 100ms ease-out;
    }

    .quiz-view-option:hover {
      transform: translateY(-0.5px);
      border-color: rgba(55, 65, 81, 1);
    }

    .quiz-view-option.correct {
      border-color: #22c55e;
      background: radial-gradient(circle at left, rgba(34, 197, 94, 0.18), transparent 60%),
                  rgba(15, 23, 42, 0.96);
    }

    .quiz-view-option.wrong {
      border-color: #ef4444;
      background: radial-gradient(circle at left, rgba(239, 68, 68, 0.18), transparent 60%),
                  rgba(15, 23, 42, 0.96);
    }

    .quiz-view-badge {
      font-size: 10px;
      padding: 3px 6px;
      border-radius: 999px;
      border: 1px solid rgba(31, 41, 55, 1);
      color: var(--muted);
    }

    .quiz-view-badge.correct {
      border-color: #22c55e;
      color: #bbf7d0;
    }

    .quiz-view-badge.answer {
      border-color: var(--accent);
      color: #e0f2fe;
    }
  </style>
</head>
<body>
  <div class="app-shell">
    <div class="app-inner">
      <aside class="app-aside">
        <div>
          <div class="logo-row">
            <div class="logo-mark"></div>
            <div>
              <div class="logo-text-main">Local Quiz Studio</div>
              <div class="logo-text-sub">Offline workspace</div>
            </div>
          </div>

          <div class="aside-hero">
            <h1 class="aside-heading">
              Create and store <span>personal quizzes</span> directly in your browser.
            </h1>
            <p class="aside-body">
              Each account has its own isolated space with quizzes, analytics, and a quick editor.
              Everything is stored locally using browser storage, so nothing leaves this device.
            </p>
            <div class="aside-highlights">
              <div class="pill">
                <span class="pill-dot"></span>
                Multi user, local only
              </div>
              <div class="pill">
                <span class="pill-dot"></span>
                Sample demo account
              </div>
              <div class="pill">
                <span class="pill-dot"></span>
                Visual quiz builder
              </div>
              <div class="pill">
                <span class="pill-dot"></span>
                No server required
              </div>
            </div>
          </div>
        </div>

        <div class="aside-footer">
          Tip: Try the demo account
          <span>demo@example.com / demo</span>
          to explore the dashboard and sample quizzes.
        </div>
      </aside>

      <main class="app-main">
        <div class="top-row">
          <div>
            <div class="top-title">Workspace</div>
            <div class="status-badge">
              <span class="status-dot"></span>
              Local storage active
            </div>
          </div>
          <div class="user-chip" id="userChip">Not signed in</div>
        </div>

        <div class="card-shell">
          <div class="card-inner">
            <div class="card-header">
              <div class="card-header-main">
                <div class="card-title" id="cardTitle">Access portal</div>
                <div class="card-subtitle" id="cardSubtitle">
                  Sign in or create an account to open your personal dashboard.
                </div>
              </div>
            </div>

            <div class="chip-row" id="chipRow">
              <div class="chip" id="chipMode">Mode: Auth</div>
            </div>

            <div class="divider"></div>

            <div class="status-line" id="statusLine"></div>

            <div class="content-scroll">
              <!-- View: Auth -->
              <section class="view active" id="view-auth">
                <div class="tabs" id="authTabs">
                  <button class="tab active" data-tab="login">Sign in</button>
                  <button class="tab" data-tab="signup">Sign up</button>
                </div>

                <section id="loginSection">
                  <div class="form-grid mt-4">
                    <div class="field-group">
                      <label for="loginEmail">Email or username</label>
                      <input
                        id="loginEmail"
                        type="text"
                        autocomplete="username"
                        placeholder="you@example.com"
                      />
                    </div>
                    <div class="field-group">
                      <label for="loginPassword">Password</label>
                      <input
                        id="loginPassword"
                        type="password"
                        autocomplete="current-password"
                        placeholder="Enter password"
                      />
                    </div>
                  </div>
                  <div class="hint mt-4">
                    No account yet?
                    <button class="inline-link" type="button" id="gotoSignupLink">
                      Create one here.
                    </button>
                  </div>
                  <div class="button-row">
                    <button class="btn btn-ghost btn-sm" type="button" id="demoFill">
                      Use demo credentials
                    </button>
                    <button class="btn btn-primary" type="button" id="loginBtn">
                      Login
                    </button>
                  </div>
                </section>

                <section id="signupSection" style="display: none;">
                  <div class="form-grid mt-4">
                    <div class="field-group">
                      <label for="signupEmail">Email or username</label>
                      <input
                        id="signupEmail"
                        type="text"
                        autocomplete="username"
                        placeholder="you@example.com"
                      />
                    </div>
                    <div class="field-group">
                      <label for="signupPassword">Password</label>
                      <input
                        id="signupPassword"
                        type="password"
                        autocomplete="new-password"
                        placeholder="Choose a password"
                      />
                    </div>
                    <div class="field-group">
                      <label for="signupPasswordConfirm">Confirm password</label>
                      <input
                        id="signupPasswordConfirm"
                        type="password"
                        autocomplete="new-password"
                        placeholder="Re-enter password"
                      />
                    </div>
                  </div>
                  <div class="hint mt-4">
                    Already have an account?
                    <button class="inline-link" type="button" id="gotoLoginLink">
                      Sign in instead.
                    </button>
                  </div>
                  <div class="button-row">
                    <button class="btn btn-primary" type="button" id="signupBtn">
                      Create account
                    </button>
                  </div>
                </section>
              </section>

              <!-- View: Dashboard -->
              <section class="view" id="view-dashboard">
                <div class="editor-section">
                  <div class="editor-title-row">
                    <h3 id="dashboardWelcome">Dashboard</h3>
                    <span class="hint" id="dashboardHint">
                      Per-account quiz analytics and management.
                    </span>
                  </div>

                  <div class="metrics-row">
                    <div class="metric-card">
                      <div class="metric-label">Quizzes</div>
                      <div class="metric-value" id="metricQuizzes">0</div>
                      <div class="metric-sub">Saved for this account</div>
                    </div>
                    <div class="metric-card">
                      <div class="metric-label">Questions</div>
                      <div class="metric-value" id="metricQuestions">0</div>
                      <div class="metric-sub">Across all quizzes</div>
                    </div>
                    <div class="metric-card">
                      <div class="metric-label">Last updated</div>
                      <div class="metric-value" id="metricUpdated">â€“</div>
                      <div class="metric-sub">Most recent change</div>
                    </div>
                  </div>

                  <div class="button-row mt-4" style="justify-content: space-between;">
                    <div class="hint">
                      Click a quiz card to open it, or use Create new quiz to start fresh.
                    </div>
                    <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                      <button class="btn btn-primary btn-sm" type="button" id="newQuizBtn">
                        Create new quiz
                      </button>
                      <button class="btn btn-ghost btn-sm" type="button" id="logoutBtn">
                        Logout
                      </button>
                      <button class="btn btn-danger btn-sm" type="button" id="deleteAccountOpenBtn">
                        Delete account
                      </button>
                    </div>
                  </div>
                </div>

                <div class="quiz-list" id="quizList"></div>
                <div class="empty-state" id="quizEmptyState">
                  No quizzes yet. Use Create new quiz above to create your first quiz.
                </div>

                <div id="deleteAccountPanel" class="editor-section" style="display: none; margin-top: 10px;">
                  <div class="editor-title-row">
                    <h3>Delete this account</h3>
                  </div>
                  <p class="danger-note">
                    This removes the account and all of its quizzes from this browser.
                    This action cannot be undone.
                  </p>
                  <div class="form-grid mt-2">
                    <div class="field-group">
                      <label for="deleteEmail">Confirm email or username</label>
                      <input id="deleteEmail" type="text" />
                    </div>
                    <div class="field-group">
                      <label for="deletePassword">Confirm password</label>
                      <input id="deletePassword" type="password" />
                    </div>
                  </div>
                  <div class="button-row mt-4">
                    <button class="btn btn-ghost btn-sm" type="button" id="cancelDeleteAccountBtn">
                      Cancel
                    </button>
                    <button class="btn btn-danger btn-sm" type="button" id="confirmDeleteAccountBtn">
                      Permanently delete
                    </button>
                  </div>
                </div>
              </section>

              <!-- View: Quiz editor -->
              <section class="view" id="view-editor">
                <div class="editor-section">
                  <div class="editor-title-row">
                    <h3 id="editorHeading">New quiz</h3>
                    <span class="hint" id="editorMeta"></span>
                  </div>

                  <div class="button-row mt-2" style="justify-content: flex-start;">
                    <button class="btn btn-ghost btn-sm" type="button" id="backFromEditorBtn">
                      Back to dashboard
                    </button>
                  </div>

                  <div class="field-group mt-4">
                    <label for="quizTitle">Quiz title</label>
                    <input
                      id="quizTitle"
                      type="text"
                      placeholder="Example: JavaScript basics"
                    />
                  </div>

                  <div class="hint mt-2">
                    For each question, add options and use the round selector to mark which option is correct.
                  </div>

                  <div class="questions-list mt-4" id="questionsList"></div>

                  <div class="button-row mt-4">
                    <button class="btn btn-ghost btn-sm" type="button" id="addQuestionBtn">
                      Add question
                    </button>
                    <div style="flex: 1;"></div>
                    <button class="btn btn-ghost btn-sm" type="button" id="cancelEditBtn">
                      Cancel
                    </button>
                    <button class="btn btn-primary btn-sm" type="button" id="saveQuizBtn">
                      Save quiz
                    </button>
                  </div>
                </div>
              </section>

              <!-- View: Quiz page (play/view) -->
              <section class="view" id="view-quiz">
                <div class="editor-section">
                  <div class="quiz-view-header">
                    <div>
                      <div class="quiz-view-title" id="quizViewTitle"></div>
                      <div class="quiz-view-meta" id="quizViewMeta"></div>
                    </div>
                    <div class="button-row" style="margin-top: 0;">
                      <button class="btn btn-ghost btn-sm" type="button" id="backFromQuizBtn">
                        Back to dashboard
                      </button>
                      <button class="btn btn-primary btn-sm" type="button" id="editFromQuizBtn">
                        Edit this quiz
                      </button>
                    </div>
                  </div>

                  <div class="hint mt-4">
                    Click an option to check your answer. Correct answers are highlighted in green.
                  </div>

                  <div id="quizViewQuestions"></div>
                </div>
              </section>
            </div>
          </div>
        </div>
      </main>
    </div>
  </div>

  <script>
    const STORAGE_KEY = "localQuizStudioData_v2";

    function loadState() {
      const raw = localStorage.getItem(STORAGE_KEY);
      if (!raw) {
        const now = new Date().toISOString();
        const sampleQuiz = {
          id: "demo-quiz-1",
          title: "Sample general knowledge quiz",
          updatedAt: now,
          questions: [
            {
              id: "demo-q-1",
              text: "Which language runs in a web browser?",
              options: [
                { id: "demo-q1-o1", text: "Java", isCorrect: false },
                { id: "demo-q1-o2", text: "C", isCorrect: false },
                { id: "demo-q1-o3", text: "Python", isCorrect: false },
                { id: "demo-q1-o4", text: "JavaScript", isCorrect: true }
              ]
            },
            {
              id: "demo-q-2",
              text: "What does HTML stand for?",
              options: [
                { id: "demo-q2-o1", text: "Hyperlinks and Text Markup Language", isCorrect: false },
                { id: "demo-q2-o2", text: "Home Tool Markup Language", isCorrect: false },
                { id: "demo-q2-o3", text: "Hyper Text Markup Language", isCorrect: true },
                { id: "demo-q2-o4", text: "Hyperlinks Text Making Language", isCorrect: false }
              ]
            }
          ]
        };

        const initial = {
          users: {
            "demo@example.com": {
              password: "demo",
              quizzes: [sampleQuiz]
            }
          },
          currentUser: null
        };
        localStorage.setItem(STORAGE_KEY, JSON.stringify(initial));
        return initial;
      }
      try {
        return JSON.parse(raw);
      } catch {
        const fallback = { users: {}, currentUser: null };
        localStorage.setItem(STORAGE_KEY, JSON.stringify(fallback));
        return fallback;
      }
    }

    function saveState(state) {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
    }

    let appState = loadState();
    let editingQuiz = null;
    let currentQuizForView = null;

    const statusLine = document.getElementById("statusLine");
    const cardTitle = document.getElementById("cardTitle");
    const cardSubtitle = document.getElementById("cardSubtitle");
    const chipMode = document.getElementById("chipMode");
    const userChip = document.getElementById("userChip");

    const viewAuth = document.getElementById("view-auth");
    const viewDashboard = document.getElementById("view-dashboard");
    const viewEditor = document.getElementById("view-editor");
    const viewQuiz = document.getElementById("view-quiz");

    const authTabs = document.getElementById("authTabs");
    const loginSection = document.getElementById("loginSection");
    const signupSection = document.getElementById("signupSection");

    const loginEmail = document.getElementById("loginEmail");
    const loginPassword = document.getElementById("loginPassword");
    const signupEmail = document.getElementById("signupEmail");
    const signupPassword = document.getElementById("signupPassword");
    const signupPasswordConfirm = document.getElementById("signupPasswordConfirm");

    const dashboardWelcome = document.getElementById("dashboardWelcome");
    const metricQuizzes = document.getElementById("metricQuizzes");
    const metricQuestions = document.getElementById("metricQuestions");
    const metricUpdated = document.getElementById("metricUpdated");

    const quizList = document.getElementById("quizList");
    const quizEmptyState = document.getElementById("quizEmptyState");

    const deleteAccountPanel = document.getElementById("deleteAccountPanel");
    const deleteEmail = document.getElementById("deleteEmail");
    const deletePassword = document.getElementById("deletePassword");

    const editorHeading = document.getElementById("editorHeading");
    const editorMeta = document.getElementById("editorMeta");
    const quizTitleInput = document.getElementById("quizTitle");
    const questionsList = document.getElementById("questionsList");

    const quizViewTitle = document.getElementById("quizViewTitle");
    const quizViewMeta = document.getElementById("quizViewMeta");
    const quizViewQuestions = document.getElementById("quizViewQuestions");

    function setStatus(message, type = "info") {
      if (!message) {
        statusLine.textContent = "";
        return;
      }
      if (type === "error") {
        statusLine.innerHTML = "<strong>Error:</strong> " + message;
      } else if (type === "success") {
        statusLine.innerHTML = "<strong>Success:</strong> " + message;
      } else {
        statusLine.textContent = message;
      }
    }

    function getCurrentUserId() {
      appState = loadState();
      return appState.currentUser;
    }

    function getCurrentUser() {
      const id = getCurrentUserId();
      if (!id) return null;
      return appState.users[id] || null;
    }

    function updateUserChip() {
      const userId = getCurrentUserId();
      if (!userId) {
        userChip.textContent = "Not signed in";
      } else {
        userChip.textContent = "Signed in as " + userId;
      }
    }

    function showView(name) {
      [viewAuth, viewDashboard, viewEditor, viewQuiz].forEach(v => v.classList.remove("active"));

      if (name === "auth") {
        viewAuth.classList.add("active");
        cardTitle.textContent = "Access portal";
        cardSubtitle.textContent =
          "Sign in or create an account, then move into your dashboard.";
        chipMode.textContent = "Mode: Auth";
      } else if (name === "dashboard") {
        viewDashboard.classList.add("active");
        cardTitle.textContent = "Dashboard";
        cardSubtitle.textContent =
          "Overview of your quizzes and activity. Data is stored per account in this browser.";
        chipMode.textContent = "Mode: Dashboard";
      } else if (name === "editor") {
        viewEditor.classList.add("active");
        cardTitle.textContent = "Quiz editor";
        cardSubtitle.textContent =
          "Define questions, options, and mark which answer is correct.";
        chipMode.textContent = "Mode: Editor";
      } else if (name === "quiz") {
        viewQuiz.classList.add("active");
        cardTitle.textContent = "Quiz view";
        cardSubtitle.textContent =
          "Practice with this quiz. Answers are checked locally in the browser.";
        chipMode.textContent = "Mode: Quiz";
      }
    }

    function switchAuthTab(tabName) {
      authTabs.querySelectorAll(".tab").forEach(tab => {
        const active = tab.dataset.tab === tabName;
        tab.classList.toggle("active", active);
      });
      if (tabName === "login") {
        loginSection.style.display = "";
        signupSection.style.display = "none";
      } else {
        loginSection.style.display = "none";
        signupSection.style.display = "";
      }
    }

    function handleLogin() {
      const id = loginEmail.value.trim();
      const password = loginPassword.value;

      if (!id || !password) {
        setStatus("Please provide both identifier and password.", "error");
        return;
      }

      appState = loadState();
      const user = appState.users[id];
      if (!user) {
        setStatus("User not found. Use sign up to create a new account.", "error");
        return;
      }
      if (user.password !== password) {
        setStatus("Incorrect password. Please try again.", "error");
        return;
      }

      appState.currentUser = id;
      saveState(appState);
      loginPassword.value = "";
      setStatus("Login successful. Loading your dashboard.", "success");
      updateUserChip();
      renderDashboard();
      showView("dashboard");
    }

    function handleSignup() {
      const id = signupEmail.value.trim();
      const pw = signupPassword.value;
      const pw2 = signupPasswordConfirm.value;

      if (!id || !pw || !pw2) {
        setStatus("Please fill in all fields to create an account.", "error");
        return;
      }

      if (pw !== pw2) {
        setStatus("Passwords do not match.", "error");
        return;
      }

      appState = loadState();
      if (appState.users[id]) {
        setStatus("An account with this identifier already exists.", "error");
        return;
      }

      appState.users[id] = {
        password: pw,
        quizzes: []
      };
      saveState(appState);

      setStatus("Account created. You can now sign in.", "success");
      signupPassword.value = "";
      signupPasswordConfirm.value = "";
      switchAuthTab("login");
    }

    function handleLogout() {
      appState = loadState();
      appState.currentUser = null;
      saveState(appState);
      setStatus("You have been logged out.", "info");
      updateUserChip();
      showView("auth");
    }

    function showDeleteAccountPanel() {
      const user = getCurrentUser();
      if (!user) return;
      deleteEmail.value = appState.currentUser;
      deletePassword.value = "";
      deleteAccountPanel.style.display = "";
    }

    function hideDeleteAccountPanel() {
      deleteAccountPanel.style.display = "none";
      deletePassword.value = "";
    }

    function handleDeleteAccount() {
      const idInput = deleteEmail.value.trim();
      const pw = deletePassword.value;

      const currentId = getCurrentUserId();
      if (!currentId) {
        setStatus("No user is currently signed in.", "error");
        return;
      }

      appState = loadState();
      const user = appState.users[currentId];
      if (!user) {
        setStatus("User not found in storage.", "error");
        return;
      }

      if (idInput !== currentId) {
        setStatus("Identifier does not match the account currently signed in.", "error");
        return;
      }

      if (user.password !== pw) {
        setStatus("Incorrect password. Account was not deleted.", "error");
        return;
      }

      delete appState.users[currentId];
      appState.currentUser = null;
      saveState(appState);

      setStatus("Account and all associated quizzes have been deleted.", "success");
      hideDeleteAccountPanel();
      updateUserChip();
      showView("auth");
    }

    function createEmptyQuestion() {
      return {
        id: "q-" + crypto.randomUUID(),
        text: "",
        options: [
          { id: "o-" + crypto.randomUUID(), text: "", isCorrect: false },
          { id: "o-" + crypto.randomUUID(), text: "", isCorrect: false }
        ]
      };
    }

    function ensureAtLeastOneQuestion() {
      if (!editingQuiz.questions || editingQuiz.questions.length === 0) {
        editingQuiz.questions = [createEmptyQuestion()];
      }
    }

    function addQuestion() {
      editingQuiz.questions.push(createEmptyQuestion());
      renderQuestions();
    }

    function deleteQuestion(questionId) {
      if (!editingQuiz.questions) return;
      if (editingQuiz.questions.length === 1) {
        setStatus("At least one question is required in a quiz.", "error");
        return;
      }
      editingQuiz.questions = editingQuiz.questions.filter(q => q.id !== questionId);
      renderQuestions();
    }

    function addOption(questionId) {
      const q = editingQuiz.questions.find(q => q.id === questionId);
      if (!q) return;
      q.options.push({
        id: "o-" + crypto.randomUUID(),
        text: "",
        isCorrect: false
      });
      renderQuestions();
    }

    function deleteOption(questionId, optionId) {
      const q = editingQuiz.questions.find(q => q.id === questionId);
      if (!q) return;
      if (q.options.length <= 2) {
        setStatus("A question needs at least two options.", "error");
        return;
      }
      q.options = q.options.filter(o => o.id !== optionId);
      renderQuestions();
    }

    function updateQuestionText(questionId, newText) {
      const q = editingQuiz.questions.find(q => q.id === questionId);
      if (!q) return;
      q.text = newText;
    }

    function updateOptionText(questionId, optionId, newText) {
      const q = editingQuiz.questions.find(q => q.id === questionId);
      if (!q) return;
      const opt = q.options.find(o => o.id === optionId);
      if (!opt) return;
      opt.text = newText;
    }

    function setCorrectOption(questionId, optionId) {
      const q = editingQuiz.questions.find(q => q.id === questionId);
      if (!q) return;
      q.options.forEach(o => {
        o.isCorrect = (o.id === optionId);
      });
      renderQuestions();
    }

    function renderQuestions() {
      questionsList.innerHTML = "";
      if (!editingQuiz || !editingQuiz.questions) return;

      editingQuiz.questions.forEach((q, index) => {
        const questionCard = document.createElement("div");
        questionCard.className = "question-card";

        const header = document.createElement("div");
        header.className = "question-header";

        const label = document.createElement("div");
        label.className = "question-label";
        label.textContent = "Question " + (index + 1);

        const qActions = document.createElement("div");
        qActions.className = "question-actions";

        const deleteBtn = document.createElement("button");
        deleteBtn.type = "button";
        deleteBtn.className = "btn btn-ghost btn-sm";
        deleteBtn.textContent = "Delete question";
        deleteBtn.addEventListener("click", () => deleteQuestion(q.id));
        qActions.appendChild(deleteBtn);

        const addOptBtn = document.createElement("button");
        addOptBtn.type = "button";
        addOptBtn.className = "btn btn-ghost btn-sm";
        addOptBtn.textContent = "Add option";
        addOptBtn.addEventListener("click", () => addOption(q.id));
        qActions.appendChild(addOptBtn);

        header.appendChild(label);
        header.appendChild(qActions);

        const textGroup = document.createElement("div");
        textGroup.className = "field-group";
        const textLabel = document.createElement("label");
        textLabel.textContent = "Question text";
        const textInput = document.createElement("input");
        textInput.type = "text";
        textInput.value = q.text || "";
        textInput.placeholder = "Enter question text";
        textInput.addEventListener("input", (e) => updateQuestionText(q.id, e.target.value));
        textGroup.appendChild(textLabel);
        textGroup.appendChild(textInput);

        const optionsContainer = document.createElement("div");
        optionsContainer.className = "options-list";

        q.options.forEach((o, idx) => {
          const row = document.createElement("div");
          row.className = "option-row";

          const radio = document.createElement("input");
          radio.type = "radio";
          radio.className = "option-radio";
          radio.name = "correct-" + q.id;
          radio.checked = !!o.isCorrect;
          radio.title = "Mark this option as the correct answer";
          radio.addEventListener("change", () => setCorrectOption(q.id, o.id));

          const text = document.createElement("input");
          text.type = "text";
          text.value = o.text || "";
          text.placeholder = "Option " + (idx + 1);
          text.addEventListener("input", (e) =>
            updateOptionText(q.id, o.id, e.target.value)
          );

          const delBtn = document.createElement("button");
          delBtn.type = "button";
          delBtn.className = "option-delete-btn";
          delBtn.textContent = "Remove";
          delBtn.addEventListener("click", () => deleteOption(q.id, o.id));

          row.appendChild(radio);
          row.appendChild(text);
          row.appendChild(delBtn);

          optionsContainer.appendChild(row);
        });

        questionCard.appendChild(header);
        questionCard.appendChild(textGroup);
        questionCard.appendChild(optionsContainer);
        questionsList.appendChild(questionCard);
      });
    }

    function showQuizEditor(quiz) {
      const user = getCurrentUser();
      if (!user) {
        setStatus("Please sign in to edit quizzes.", "error");
        showView("auth");
        return;
      }

      if (quiz) {
        editingQuiz = JSON.parse(JSON.stringify(quiz));
        editorHeading.textContent = "Edit quiz";
        editorMeta.textContent = "Update questions, options, and correct answers for this quiz.";
      } else {
        editingQuiz = {
          id: "quiz-" + crypto.randomUUID(),
          title: "",
          updatedAt: null,
          questions: [createEmptyQuestion()]
        };
        editorHeading.textContent = "New quiz";
        editorMeta.textContent = "Define a title, add questions, and mark the correct answers.";
      }

      quizTitleInput.value = editingQuiz.title || "";
      ensureAtLeastOneQuestion();
      renderQuestions();
      setStatus("Quiz editor open. Remember to save your changes.", "info");
      showView("editor");
    }

    function validateQuiz(quiz) {
      if (!quiz.title || !quiz.title.trim()) {
        return "Please provide a title for the quiz.";
      }
      if (!quiz.questions || quiz.questions.length === 0) {
        return "Add at least one question.";
      }
      for (const [idx, q] of quiz.questions.entries()) {
        if (!q.text || !q.text.trim()) {
          return "Question " + (idx + 1) + " is missing text.";
        }
        if (!q.options || q.options.length < 2) {
          return "Question " + (idx + 1) + " must have at least two options.";
        }
        let hasCorrect = false;
        for (const o of q.options) {
          if (!o.text || !o.text.trim()) {
            return "Every option must have text.";
          }
          if (o.isCorrect) hasCorrect = true;
        }
        if (!hasCorrect) {
          return "Question " + (idx + 1) + " must have one correct answer selected.";
        }
      }
      return null;
    }

    function saveQuiz() {
      if (!editingQuiz) return;

      editingQuiz.title = quizTitleInput.value.trim();
      editingQuiz.updatedAt = new Date().toISOString();

      const error = validateQuiz(editingQuiz);
      if (error) {
        setStatus(error, "error");
        return;
      }

      appState = loadState();
      const userId = getCurrentUserId();
      if (!userId) {
        setStatus("No active user. Please log in again.", "error");
        return;
      }

      const user = appState.users[userId];
      if (!user) {
        setStatus("User not found in storage.", "error");
        return;
      }

      const idx = user.quizzes.findIndex(q => q.id === editingQuiz.id);
      if (idx === -1) user.quizzes.push(editingQuiz);
      else user.quizzes[idx] = editingQuiz;

      saveState(appState);
      setStatus("Quiz saved for this account.", "success");
      renderDashboard();
      showView("dashboard");
    }

    function deleteQuiz(quizId) {
      appState = loadState();
      const userId = getCurrentUserId();
      if (!userId) {
        setStatus("No active user. Please log in again.", "error");
        return;
      }

      const user = appState.users[userId];
      if (!user) {
        setStatus("User not found in storage.", "error");
        return;
      }

      user.quizzes = user.quizzes.filter(q => q.id !== quizId);
      saveState(appState);
      setStatus("Quiz deleted.", "success");
      renderDashboard();
    }

    function formatDate(iso) {
      if (!iso) return "â€“";
      try {
        const d = new Date(iso);
        if (Number.isNaN(d.getTime())) return "â€“";
        return d.toLocaleDateString(undefined, {
          year: "numeric",
          month: "short",
          day: "numeric"
        });
      } catch {
        return "â€“";
      }
    }

    function renderDashboard() {
      appState = loadState();
      const userId = getCurrentUserId();
      const user = userId ? appState.users[userId] : null;
      if (!user) return;

      dashboardWelcome.textContent = "Dashboard for " + userId;

      const quizzes = user.quizzes || [];
      let totalQuestions = 0;
      let latestUpdated = null;
      quizzes.forEach(q => {
        if (q.questions) totalQuestions += q.questions.length;
        if (q.updatedAt) {
          if (!latestUpdated || q.updatedAt > latestUpdated) {
            latestUpdated = q.updatedAt;
          }
        }
      });

      metricQuizzes.textContent = quizzes.length;
      metricQuestions.textContent = totalQuestions;
      metricUpdated.textContent = formatDate(latestUpdated);

      quizList.innerHTML = "";
      if (quizzes.length === 0) {
        quizEmptyState.style.display = "";
      } else {
        quizEmptyState.style.display = "none";
        quizzes.forEach(quiz => {
          const card = document.createElement("div");
          card.className = "quiz-card";

          const main = document.createElement("div");
          main.className = "quiz-main";

          const title = document.createElement("div");
          title.className = "quiz-title";
          title.textContent = quiz.title || "Untitled quiz";

          const meta = document.createElement("div");
          meta.className = "quiz-meta";
          const questionCount = quiz.questions ? quiz.questions.length : 0;
          let totalOptions = 0;
          if (quiz.questions) {
            for (const q of quiz.questions) {
              totalOptions += q.options ? q.options.length : 0;
            }
          }
          const updatedText = formatDate(quiz.updatedAt);
          meta.textContent =
            questionCount + " questions, " + totalOptions + " options Â· Updated " + updatedText;

          main.appendChild(title);
          main.appendChild(meta);

          const actions = document.createElement("div");
          actions.className = "quiz-actions";

          const editBtn = document.createElement("button");
          editBtn.type = "button";
          editBtn.className = "btn btn-ghost btn-sm";
          editBtn.textContent = "Edit";
          editBtn.addEventListener("click", (e) => {
            e.stopPropagation();
            showQuizEditor(quiz);
          });

          const deleteBtn = document.createElement("button");
          deleteBtn.type = "button";
          deleteBtn.className = "btn btn-danger btn-sm";
          deleteBtn.textContent = "Delete";
          deleteBtn.addEventListener("click", (e) => {
            e.stopPropagation();
            deleteQuiz(quiz.id);
          });

          actions.appendChild(editBtn);
          actions.appendChild(deleteBtn);

          card.appendChild(main);
          card.appendChild(actions);

          card.addEventListener("click", () => openQuizView(quiz));

          quizList.appendChild(card);
        });
      }
    }

    function openQuizView(quiz) {
      currentQuizForView = JSON.parse(JSON.stringify(quiz));
      renderQuizView();
      setStatus("Quiz view open. Click options to check your answers.", "info");
      showView("quiz");
    }

    function renderQuizView() {
      if (!currentQuizForView) return;
      const quiz = currentQuizForView;

      quizViewTitle.textContent = quiz.title || "Untitled quiz";
      const questionCount = quiz.questions ? quiz.questions.length : 0;
      let totalOptions = 0;
      if (quiz.questions) {
        for (const q of quiz.questions) {
          totalOptions += q.options ? q.options.length : 0;
        }
      }
      quizViewMeta.textContent =
        questionCount + " questions Â· " + totalOptions + " options Â· Updated " + formatDate(quiz.updatedAt);

      quizViewQuestions.innerHTML = "";
      if (!quiz.questions || quiz.questions.length === 0) {
        const empty = document.createElement("div");
        empty.className = "empty-state mt-4";
        empty.textContent = "This quiz has no questions yet.";
        quizViewQuestions.appendChild(empty);
        return;
      }

      quiz.questions.forEach((q, qIndex) => {
        const qCard = document.createElement("div");
        qCard.className = "quiz-view-question";

        const label = document.createElement("div");
        label.className = "question-label";
        label.textContent = "Question " + (qIndex + 1);

        const qText = document.createElement("div");
        qText.className = "quiz-view-qtext";
        qText.textContent = q.text;

        const optionsContainer = document.createElement("div");
        optionsContainer.className = "quiz-view-options";

        q.options.forEach((o) => {
          const row = document.createElement("button");
          row.type = "button";
          row.className = "quiz-view-option";
          row.dataset.correct = o.isCorrect ? "true" : "false";

          const labelSpan = document.createElement("span");
          labelSpan.textContent = o.text;

          const badge = document.createElement("span");
          badge.className = "quiz-view-badge";
          badge.textContent = "";

          if (o.isCorrect) {
            badge.classList.add("answer");
            badge.textContent = "Correct answer";
          }

          row.appendChild(labelSpan);
          row.appendChild(badge);

          row.addEventListener("click", () => {
            const alreadyChecked = row.classList.contains("correct") || row.classList.contains("wrong");
            if (alreadyChecked) return;

            const allOptions = optionsContainer.querySelectorAll(".quiz-view-option");
            allOptions.forEach(optEl => {
              const isCorr = optEl.dataset.correct === "true";
              if (isCorr) {
                optEl.classList.add("correct");
                const b = optEl.querySelector(".quiz-view-badge");
                if (b) {
                  b.classList.add("correct");
                  if (!b.textContent) b.textContent = "Correct";
                }
              }
            });

            if (o.isCorrect) {
              row.classList.add("correct");
            } else {
              row.classList.add("wrong");
            }
          });

          optionsContainer.appendChild(row);
        });

        qCard.appendChild(label);
        qCard.appendChild(qText);
        qCard.appendChild(optionsContainer);
        quizViewQuestions.appendChild(qCard);
      });
    }

    document.getElementById("loginBtn").addEventListener("click", handleLogin);
    document.getElementById("signupBtn").addEventListener("click", handleSignup);
    document.getElementById("logoutBtn").addEventListener("click", handleLogout);

    document.getElementById("newQuizBtn").addEventListener("click", () =>
      showQuizEditor(null)
    );
    document.getElementById("saveQuizBtn").addEventListener("click", saveQuiz);
    document.getElementById("cancelEditBtn").addEventListener("click", () => {
      showView("dashboard");
      setStatus("Quiz editing cancelled. No changes were saved.", "info");
    });
    document.getElementById("backFromEditorBtn").addEventListener("click", () => {
      showView("dashboard");
      setStatus("Returned to dashboard.", "info");
    });

    document.getElementById("backFromQuizBtn").addEventListener("click", () => {
      showView("dashboard");
      setStatus("Returned to dashboard.", "info");
    });

    document.getElementById("editFromQuizBtn").addEventListener("click", () => {
      if (!currentQuizForView) return;
      showQuizEditor(currentQuizForView);
    });

    document.getElementById("deleteAccountOpenBtn").addEventListener("click", showDeleteAccountPanel);
    document.getElementById("cancelDeleteAccountBtn").addEventListener("click", hideDeleteAccountPanel);
    document.getElementById("confirmDeleteAccountBtn").addEventListener("click", handleDeleteAccount);

    document.getElementById("gotoSignupLink").addEventListener("click", () => {
      switchAuthTab("signup");
    });
    document.getElementById("gotoLoginLink").addEventListener("click", () => {
      switchAuthTab("login");
    });

    document.getElementById("demoFill").addEventListener("click", () => {
      loginEmail.value = "demo@example.com";
      loginPassword.value = "demo";
      setStatus("Demo credentials filled. Click Login to open the sample dashboard.", "info");
    });

    authTabs.querySelectorAll(".tab").forEach((tab) => {
      tab.addEventListener("click", () => {
        switchAuthTab(tab.dataset.tab);
      });
    });

    updateUserChip();
    showView("auth");
    setStatus("Enter your credentials to sign in or create a new account.", "info");
  </script>
</body>
</html>
